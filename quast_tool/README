DEPRECATED. See manual instead.



== PREREQ ==

Python v.2.4 or higher
Perl v. 5.6.0 or higher

Other requirements (optional, but functionality will be increased):

	sudo apt-get install python-matplotlib python-numpy

	or

	sudo easy_install matplotlib numpy

For run Mauve:
The mauve software requires access to a graphical user interface. If running the software remotely on a server, one can use the ssh -X servername option to connect the local display to the remote server. 
In the event that X forwarding is not possible we recommend using VNC:
    sudo apt-get install vnc4server
    vncserver start  // and you should set password
In case VNC is installed and configured (i.e. password is set) the script will use it. In other case script will try to use X forwarding. If X forwarding is not possible the mauve part of the script fails.

== RUN ==
	   
    python quality.py REFERENCE_FILE CONTIG_FILES [options] [GENES_FILE(should contain "gene" in name)] [OPERONS_FILE(should contain "operon" in name)]

options:
    --gage                        run GAGE module instead of other modules (result table will be in results/gage.txt)
    --mauve, -m                   excludes computation of mauve metrics. Use of this option can significally decrease running time.
    --normal, -n                  generate comparision table (like in the Single Cell paper) for EColi normal lane data
    --sc [DEFAULT]                generate comparision table (like in the Single Cell paper) for EColi lane 1 (Single Cell) data
    --acyclic, -a                 the reference genome is acyclic
    --rc                          count reverse-complementary contigs as local misassemblies (not an Extensive ones)
    --min-contig=x                compute only contigs that are equal or larger (>=) than x. Default value is 0.
    --save-json, j                save the output also in the JSON format
    --save-json-to=path, -J=path  save the JSON-output to a particular path


NOTE: REFERENCE_FILE should precede CONTIGS_FILES, other parameters can be placed in any order.

== RESULTS ==

= INTERPRETING TOTAL REPORT =
Total report is in ./results/all.txt file

Short description of report's columns:
1. Assembly - name of input file with an assembly

2. N50 - the contig length such that using equal or longer length contigs
produces half (50%) the bases of the assembly.  Usually there is not
a value that produces exactly 50%, so the more technical definition is
the largest length x such that using contigs of length >= x accounts for
at least 50% of the bases of the assembly.

3. NG50 - the contig length such that using equal or longer length contigs
produces half (50%) the bases of the reference genome

4. N75 - like N50 but contigs should produce 75% the bases of the assembly

5. NG75 - like NG50 but contigs should produce 75% the bases of the reference
genome

6. Number of contigs - the total number of contigs in the assembly

7. Largest contig - the length of the largest contig in the assembly

8. Total length - the total number of bases in the assembly

9. Reference length - the total number of bases in the genome

10. Average %IDY - an average of alignment identity percent (quality) among all
contigs (Nucmer aligner's metric)

11. Misassemblies - the number of misassemblies in the alignment.
Misassemblies are defined as a location on an assembled contig where the left
flanking sequence aligns over 1kb away from the right flanking sequence on the
reference.

12. Misassembled Contigs - the number of contigs which contain misassembly
events

13. Misassembled Contig Bases - the number of total bases contained in all
contigs that have one or more misassemblies

14. Misassembled and Unaligned - the number of contigs which contain misassembly
events but which have alignment to the reference of length less than 10% of contigs 
length (practically unaligned contigs).

15. Unaligned Contigs - the number of contigs that have no alignment to the
reference sequence.  The value "X + Y part" means:
X totally unaligned contigs plus Y partially unaligned contigs.

16. Unaligned Contig Bases - the total number of unaligned bases in totally and 
partially unaligned contigs.

17. Ambiguous Contigs - the number of contigs which have reference alignments
of equal quality in multiple locations on the reference.
The value "X (Y)" means X ambiguous contigs with Y bases in them.

18-21. NA50, NGA50, NA75, NGA75 (A stands for "aligned") - like the same
metrics without A but in this case we count lengths of aligned blocks.
If a contig has a misassembly with respect to the reference, we break the
contig into smaller pieces.
If a contig has bases that don't align to the reference, they are not counted
in NA*, NGA*.

22. Mapped genome (%) - the ratio of total number of aligned bp in the assembly
to the genome size.  Short contigs (less than 500 bp) that map to multiple
places may be counted many times in this quantity.  A base in the genome is
counted as aligned one if there is at least one contig with at least one
alignment with this base.

23. Genes - the number of genes in the assembly (full and partial), based
on the positions the contigs map to in the reference genome with an annotated
list of genes.

The value "X + Y part" means X full genes and Y partial ones (at least 100
bases are aligned)

24. Operons - the number of operons in the assembly (full and partial), based
on the positions the contigs map to in the reference genome with an annotated
list of operons.

The value "X + Y part" means X full operons and Y partial ones (at least 100
bases are aligned)

25. Number of MisCalled - the number of miscalled bases (e.g. having "C" in the assembly and "G" in the genome)

26. Number of UnCalled - the number of uncalled bases ("N")

27. Bases Missed - the number of missed bases (which are presented in the genome and missed in the assembly)

28. Extra Bases - the number of extra bases (which are presented in the assembly and missed in the genome)

= GAGE Metrics ==
Gage metrics can be obtained in case of running Quality tool with "--gage" option
Gage metrics are in ./results/gage.txt

1. Contigs #  - the number of contigs
2. Min contig - the length of min contig
3. Max contig - the length of max contig
4. N50 - the N50 and the number of contigs with equal or larger length
5. Genome Size - the reference length
6. Assembly Size - the assembly length
7. Chaff bases
8. Missing Reference Bases - the reference bases that weren't covered by assembly
9. Missing Assembly Bases - the number of unaligned assembly bases
10. Missing Assembly Contigs - the number of unaligned assembly contigs
11. Duplicated Reference Bases
12. Compressed Reference Bases
13. Bad Trim
14. Avg Idy - an average of alignment identity percent (quality) among all
contigs (Nucmer aligner's metric)
15. SNPs
16. Indels < 5bp
17. Indels >= 5
18. Inversions
19. Relocation
20. Translocation
21. Corrected contig # - the number of contigs after GAGE correction
22. Corrected Assembly Size - the assembly length after GAGE correction
23. Min correct contig - the length of min contig after GAGE correction
24. Max correct contig - the length of max contig after GAGE correction
25. Corrected N50 - the N50 after GAGE correction


= MORE DETAILED INFORMATION =

1. Contigs' size (small number of long contigs is better than large number of short ones)

General info: 
    ./results/plotter/NGx_plot.pdf

Additional:    
    ./results/plotter/Nx_plot.pdf
    ./results/plotter/cumulative_plot.pdf
    ./results/quality.log  - values of N50 and NG50

2. Contigs' quality (alignment characteristics)

General info:
    ./results/plantakolya/plantakolya_FILENAME.stdout  - total characteristics are in the end of file

Additional:
    ./results/quality.log  - average IDY (identity) percent
    ./results/plantakolya/mummerplot_FILENAME.ps  - plot of contigs' alignment
    ./results/plantakolya/nucmer_FILENAME.coords  - coordinates of contigs and IDY values

3. Per bp characteristics

General info:
    ./results/mauve/mauve_total_miscalls.pdf     - total number of miscalled bp (e.g. C instead of G or A instead of T)
    ./results/mauve/mauve_total_missingextra.pdf - total number of missing or extra bp

Additional:
    ./results/mauve/mauve_total_extra_sizes.pdf   - number of extra segments
    ./results/mauve/mauve_total_missing_sizes.pdf - number of missing segments
    ./results/mauve/mauve_missingextra.pdf  - plot of missing and extra bp density in genome
    ./results/mauve/mauve_miscalls.pdf      - plot of miscalls density in genome

4. Genome analysis (if genes and operons were specified)

General info:
    ./results/genome_analyzer/genome_info.txt  - number of found genes (partial and full)
    ./results/genome_analyzer/genome_info.txt  - number of found operons (partial and full)

Additional:
    ./results/genome_analyzer/genome_info.txt  - genome coverage
